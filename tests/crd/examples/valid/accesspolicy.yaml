apiVersion: agentic.prototype.x-k8s.io/v0alpha0
kind: XAccessPolicy
metadata:
  name: valid-policy
spec:
  targetRefs:
  - group: agentic.prototype.x-k8s.io
    kind: XBackend
    name: valid-backend
  rules:
  - name: allow-sa
    source:
      type: ServiceAccount
      serviceAccount:
        name: my-sa
  - name: spiffe-triggers-ext-authz
    source:
      type: SPIFFE
      spiffe: spiffe://example.com/my-service
    authorization:
      type: ExternalAuth
      externalAuth:
        protocol: GRPC
        backendRef:
          name: ext-authz-svc
          port: 5000
        grpc: {}
